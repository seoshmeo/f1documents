# Webhook Integration Documentation

Все формы на сайте отправляют данные на n8n webhook:
**URL:** `https://n8n.idontcareaboutname.ru/webhook/ae7e6e72-80f7-447b-b37a-cf9da952789f`

## Метод: POST

## Content-Type: application/json

---

## 1. Модальная форма (Заказать звонок)

### Базовая структура данных:
```json
{
  "form_type": "modal",
  "title": "Заказать звонок",
  "name": "Иван Иванов",
  "phone": "+7 (900) 696-30-25",
  "timestamp": "2025-10-19T16:45:00.000Z",
  "page_url": "https://yoursite.com/index.html"
}
```

### С данными калькулятора (если открыта через "Заказать точный расчет"):
```json
{
  "form_type": "modal",
  "title": "Заказать точный расчет",
  "name": "Иван Иванов",
  "phone": "+7 (900) 696-30-25",
  "calculator_area": "25",
  "calculator_type": "Глянцевый (520 ₽/м²)",
  "calculator_total": "13 000 ₽",
  "timestamp": "2025-10-19T16:45:00.000Z",
  "page_url": "https://yoursite.com/index.html"
}
```

---

## 2. Контактная форма

### Структура данных:
```json
{
  "form_type": "contact",
  "name": "Иван Иванов",
  "phone": "+7 (900) 696-30-25",
  "email": "ivan@example.com",
  "service": "Глянцевые потолки",
  "message": "Хочу заказать установку потолка в гостиную",
  "timestamp": "2025-10-19T16:45:00.000Z",
  "page_url": "https://yoursite.com/index.html"
}
```

### Если поля не заполнены:
- `email`: "Не указан"
- `service`: "Не выбрана"
- `message`: "Нет сообщения"

---

## Варианты услуг (service):
- `Матовые потолки`
- `Глянцевые потолки`
- `Сатиновые потолки`
- `Потолки с печатью`
- `Ремонт потолков`
- `Не выбрана` (если не указано)

---

## Варианты заголовков модального окна (title):
- `Заказать звонок` (из шапки сайта)
- `Бесплатный замер` (из Hero секции)
- `Получить консультацию по выбору` (из каталога)
- `Заказать точный расчет` (из калькулятора - включает данные расчета)
- `Посмотреть все работы` (из галереи)

---

## Обработка ошибок

При ошибке отправки пользователю показывается:
```
"Произошла ошибка при отправке. Пожалуйста, позвоните нам напрямую: +7 (900) 696-30-25"
```

---

## Интеграция с Яндекс.Метрикой

После успешной отправки формы автоматически отправляются цели:
- `submit_modal_form` - для модальных окон
- `submit_contact_form` - для контактной формы
- `calculate_price` - при использовании калькулятора

---

## Пример обработки в n8n

### Webhook Node настройки:
- **HTTP Method:** POST
- **Path:** ae7e6e72-80f7-447b-b37a-cf9da952789f
- **Response Mode:** Immediately

### Доступ к данным:
```javascript
// Тип формы
{{ $json.form_type }}

// Имя клиента
{{ $json.name }}

// Телефон
{{ $json.phone }}

// Email (только для contact формы)
{{ $json.email }}

// Данные калькулятора (если есть)
{{ $json.calculator_area }}
{{ $json.calculator_type }}
{{ $json.calculator_total }}
```
